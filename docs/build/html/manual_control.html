

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Manual Control &mdash; pisloth  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://ezblock.cc/readDocFile/topHead.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="https://ezblock.cc/readDocFile/topHead.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PC Control" href="pc_control.html" />
    <link rel="prev" title="Control the Rollarm" href="control_the_rollarm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> pisloth
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components List</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_control.html">How to control</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_start_with_software.html">Getting Started with Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">Assembly</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="control_the_rollarm.html">Control the Rollarm</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Manual Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#record-behavior">Record behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#code-explanation">Code Explanation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pc_control.html">PC Control</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pisloth</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="control_the_rollarm.html">Control the Rollarm</a> &raquo;</li>
        
      <li>Manual Control</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/manual_control.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="manual-control">
<h1>Manual Control<a class="headerlink" href="#manual-control" title="Permalink to this headline">¶</a></h1>
<p><strong>Step 1:</strong> Run the <strong>Rollarm.ino</strong> code under the path <strong>DIY Control Robot Arm kit for Arduino-RollarmArduino CodeRollarm</strong>. There are four code files in Rollarm, <strong>Rollarm.ino</strong> is the main program, when the others are subprograms.</p>
<img alt="_images/media58.png" src="_images/media58.png" />
<p>When you open the main program, the subprograms will be opened automatically：</p>
<img alt="_images/media59.png" src="_images/media59.png" />
<p><strong>Step 2:</strong> Select the corresponding board and port, then click <strong>Upload</strong>.</p>
<p><strong>Step 3:</strong> After the code upload, turn the power switch on, then we can try to control the Rollarm.</p>
<p><strong>Step 4:</strong> Rotate the four potentiometer buttons to try the controlled servo and direction:</p>
<p>White potentiometer to control the Servo D, the yellow to control Servo C, the orange to control Servo B, and the red one to control Servo A.</p>
<img alt="_images/media60.png" src="_images/media60.png" />
<div class="section" id="record-behavior">
<h2>Record behavior<a class="headerlink" href="#record-behavior" title="Permalink to this headline">¶</a></h2>
<p>With the handle, the Rollarm can record its behaviors:</p>
<p><strong>Rotate one potentiometer</strong> to control one servo to the desired position, and <strong>press the yellow button shortly</strong> to let the control board record this step. Record the rest steps in this way.</p>
<p>When all the steps are done, <strong>press the yellow button for a while (3s)</strong>, it will repeat the recorded steps (Rollarm can record at most 100 steps because of the control board’s memory limit.)</p>
<img alt="_images/media61.png" src="_images/media61.png" />
<p>Thus we can make it automatically carry blocks continuously:</p>
</div>
<div class="section" id="code-explanation">
<h2>Code Explanation<a class="headerlink" href="#code-explanation" title="Permalink to this headline">¶</a></h2>
<p>The program includes three parts: rotating the potentiometers to control the Rollarm, pressing the button slightly for less than one second to record Rollarm’s behaviors and pressing the button for a relatively longer time to make Rollarm repeat the recorded steps.</p>
<p>There are four potentiometers to control the arms. The 4 servos from top to bottom are connected to port 4-7 respectively of the expansion board, and the 4 potentiometers control the ports accordingly. In other words, spin the white potentiometer to control the uppermost servo, the yellow to control the next servo below, the orange to control the next servo, and the red one to control the bottom servo.</p>
<p>Since the Rollarm has four servos acting as the moving joint, we need to include a header file for driving the servos and define them.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Create servo object to control a servo.</span>
<span class="cp">#include</span> <span class="cpf">&lt;Servo.h&gt;</span><span class="cp"></span>

<span class="n">Servo</span> <span class="n">Servo_0</span><span class="p">;</span>
<span class="n">Servo</span> <span class="n">Servo_1</span><span class="p">;</span>
<span class="n">Servo</span> <span class="n">Servo_2</span><span class="p">;</span>
<span class="n">Servo</span> <span class="n">Servo_3</span><span class="p">;</span>
</pre></div>
</div>
<p>After defining the function of driving the servos, we need to read the AD value of the potentiometers and convert it into the rotating angle of the servo since the servos are controlled by rotating the potentiometers.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Read the values ot the potentiometers.</span>
<span class="kt">void</span> <span class="nf">ReadPot</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="n">SensVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">A0</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">A1</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">A2</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">analogRead</span><span class="p">(</span><span class="n">A3</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//The value of the potentiometer is matched to the angle value.</span>
<span class="kt">void</span> <span class="nf">Mapping0</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">SensVal</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1023</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">170</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">SensVal</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1023</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">170</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">SensVal</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1023</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">170</span><span class="p">);</span>
        <span class="n">SensVal</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">SensVal</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1023</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">180</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>After compiling the program, we need to make Rollarm remember the steps, which is done through pressing the button.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Calculate the time the button pressed</span>
<span class="kt">void</span> <span class="nf">Button</span><span class="p">()</span>
<span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">digitalRead</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
                <span class="p">{</span>
                        <span class="n">KeyValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                        <span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="n">digitalRead</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                        <span class="p">{</span>
                                <span class="n">KeyValue</span><span class="o">++</span><span class="p">;</span>
                                <span class="n">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>We can tell which part of the code the Rollarm is performing by reading the value upon pressing the button. When the value is larger than 10, it means Rollarm is repeating the steps. When it is between 0 and 10, it means Rollarm is remembering. And when it is 0, it means Rollarm is being controlled by the potentiometers. The specific program is as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//Check the button.</span>
<span class="k">static</span> <span class="kt">int</span> <span class="n">Flag</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Button</span><span class="p">();</span>

<span class="c1">//The time of pressing the button is not long then record the action.</span>
<span class="k">if</span> <span class="p">((</span><span class="n">KeyValue</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">KeyValue</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span>
<span class="p">{</span>
        <span class="n">KeyValue</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">Record</span><span class="p">();</span>
        <span class="n">Mapping1</span><span class="p">();</span>
<span class="p">}</span>
<span class="c1">//Long press the button and open the auto mode,start repeating the action.</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">KeyValue</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">Flag</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="n">Calculate</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="n">Drive_init</span><span class="p">();</span>
        <span class="n">delay</span><span class="p">(</span><span class="mi">3000</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">Time</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">Drive_repeat</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//Did not press the button, open the manual mode.</span>
<span class="k">else</span>
<span class="p">{</span>
        <span class="n">ReadPot</span><span class="p">();</span>
        <span class="n">Mapping0</span><span class="p">();</span>
</pre></div>
</div>
<p>Next, we are going to call the function to write the value of the servo rotating angle. However, it is not merely about writing the values directly; the difference between two adjacent rotating values will also be written into the servos. Here we take a servo program for example.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">//The first axis.</span>
<span class="k">if</span> <span class="p">(</span><span class="n">Dif0</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">Joint0</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">Joint0</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">Servo_0</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
<span class="k">else</span>
<span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">Joint0</span><span class="p">[</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span> <span class="n">j</span> <span class="o">&gt;=</span> <span class="n">Joint0</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="n">j</span><span class="o">--</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="n">Servo_0</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">j</span><span class="p">);</span>
                <span class="n">delay</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="pc_control.html" class="btn btn-neutral float-right" title="PC Control" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="control_the_rollarm.html" class="btn btn-neutral float-left" title="Control the Rollarm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, sunfounder.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>